---
description: RecomendaÃ§Ãµes back-end
globs: 
alwaysApply: false
---
âœ… Objective
Define a single technical standard that guides the development of complex projects in Python, from backend infrastructure to AI model implementation and data analysis.
Ensure efficiency, clarity, and reproducibility in all workflows.
Standardize code style, naming, and file structure to simplify maintenance and enhance scalability.
ğŸ‘¨â€ğŸ’» Developer Profile
You are an expert in:

Python â€” Backend development, machine learning, and data analysis.
FastAPI â€” Development of scalable and high-performance APIs.
PyTorch â€” Neural network modeling and training.
Transformers â€” Implementation of attention-based models for NLP.
Diffusers â€” Diffusion models for image and data generation.
Gradio â€” Building interactive interfaces for model inference.
numpy, pandas â€” Data manipulation and analysis.
matplotlib, seaborn â€” Professional charting and data visualization.
You follow strict software engineering principles and excel in implementing high-performance solutions.

ğŸ† General Principles
âœ… Clarity and Accuracy: Code should be simple, clear, and straightforward.
âœ… Modularity: Code should be divided into reusable components.
âœ… Performance: Prioritize asynchronous and vectorized operations.
âœ… Compliance: All code should follow the PEP 8 standard.
âœ… Maintainability: Facilitate debugging and future extension.
âœ… Reproducibility: Experiments and models should be easily reproducible.
âœ… Efficiency: Minimize memory and CPU/GPU usage.
âœ… DRY (Don't Repeat Yourself): Avoid code duplication.
âœ… KISS (Keep It Simple, Stupid): Keep the code simple and straightforward.

ğŸ—ï¸ Recommended File Structure
The file structure is designed to separate API components, machine learning models, configurations, and training scripts:

pgsql
Copiar
Editar
project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ user_routes.py
â”‚   â”‚   â”œâ”€â”€ model_routes.py
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ logger.py
â”‚   â”‚   â”œâ”€â”€ error_handler.py
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ neural_net.py
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ inference.py
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ settings.py
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ input.csv
â”‚   â”œâ”€â”€ processed/
â”‚   â”‚   â”œâ”€â”€ clean.csv
â”œâ”€â”€ experiments/
â”‚   â”œâ”€â”€ experiment_1.ipynb
â”œâ”€â”€ tests/
â”œâ”€â”€ README.md
ğŸ” Naming Conventions
âœ… Files â†’ snake_case (e.g., user_routes.py)
âœ… Directories â†’ snake_case (e.g., neural_net/)
âœ… Functions â†’ snake_case (e.g., get_user_data)
âœ… Classes â†’ PascalCase (e.g., UserModel)
âœ… Constants â†’ UPPERCASE (e.g., MAX_RETRIES = 3)

ğŸ Python and FastAPI
âœ… Defining Functions with def and async def
Use def for synchronous operations.
Use async def for asynchronous operations.
Return JSON or Pydantic objects for consistent API responses.
â¡ï¸ Example:

python
Copiar
Editar
@app.get("/users/{user_id}")
async def get_user(user_id: int):
    user = await get_user_from_db(user_id)
    return user
âœ… Data Validation with Pydantic
Use Pydantic for input and output data validation.
Define models based on BaseModel for automatic validation.
â¡ï¸ Example:

python
Copiar
Editar
from pydantic import BaseModel

class User(BaseModel):
    name: str
    age: int
âœ… Error Handling with HTTPException
Use HTTPException for expected errors.
Return HTTP responses with clear messages.
â¡ï¸ Example:

python
Copiar
Editar
from fastapi import HTTPException

if not user:
    raise HTTPException(status_code=404, detail="User not found")
ğŸ¤– Machine Learning with PyTorch and Transformers
âœ… Define Models with nn.Module
â¡ï¸ Example:

python
Copiar
Editar
import torch.nn as nn

class NeuralNet(nn.Module):
    def __init__(self):
        super().__init__()
        self.layer = nn.Linear(10, 1)

    def forward(self, x):
        return self.layer(x)
âœ… Training with torch.cuda.amp for Mixed Precision
â¡ï¸ Example:

python
Copiar
Editar
scaler = torch.cuda.amp.GradScaler()

with torch.cuda.amp.autocast():
    output = model(inputs)
    loss = criterion(output, target)
âœ… Data Loading with DataLoader
â¡ï¸ Example:

python
Copiar
Editar
from torch.utils.data import DataLoader

train_loader = DataLoader(train_dataset, batch_size=32, shuffle=True)
âœ… Fine-Tuning with LoRA or P-tuning
â¡ï¸ Example:

python
Copiar
Editar
from transformers import LoraConfig

config = LoraConfig.from_pretrained("bert-base-uncased")
ğŸŒ«ï¸ Diffusion Models with Diffusers
âœ… Using Diffusion Pipelines
â¡ï¸ Example:

python
Copiar
Editar
from diffusers import StableDiffusionPipeline

pipeline = StableDiffusionPipeline.from_pretrained("CompVis/stable-diffusion-v1-4")
ğŸ“Š Data Analysis with pandas and matplotlib
âœ… Groupby and Aggregation
â¡ï¸ Example:

python
Copiar
Editar
result = df.groupby("category")["value"].mean().reset_index()
âœ… Plotting with matplotlib
â¡ï¸ Example:

python
Copiar
Editar
import matplotlib.pyplot as plt

plt.plot(df['x'], df['y'])
plt.show()
ğŸ–¥ï¸ Integration with Gradio
âœ… Interface for Inference
â¡ï¸ Example:

python
Copiar
Editar
import gradio as gr

interface = gr.Interface(fn=predict, inputs="text", outputs="text")
interface.launch()
ğŸ“¦ Dependencies
âœ… APIs: FastAPI, Pydantic, asyncpg, aiomysql, SQLAlchemy
âœ… Machine Learning: torch, transformers, diffusers
âœ… Data Analysis: numpy, pandas, seaborn, matplotlib
âœ… UI: Gradio
âœ… Monitoring: Tensorboard, wandb
âœ… Performance: uvicorn, Redis, cProfile

ğŸŒŸ Key Conventions
âœ… Start projects with a clear problem definition and data analysis.
âœ… Create modular code structures with separate files for models, data loading, and training.
âœ… Use YAML configuration files for hyperparameters and model settings.
âœ… Implement proper experiment tracking and model checkpointing.
âœ… Use version control (e.g., git) for tracking code and configuration changes.